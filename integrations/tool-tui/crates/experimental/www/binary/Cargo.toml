[package]
name = "dx-www-binary"
version.workspace = true
edition.workspace = true
license.workspace = true
description = "The binary protocol that killed JSON and HTML"
repository.workspace = true
keywords = ["binary", "wasm", "dx", "protocol", "htip"]
categories = ["wasm", "encoding"]
authors.workspace = true

[dependencies]
serde = { version = "1.0", features = ["derive"] }
ed25519-dalek = { version = "2.1.0", features = ["serde", "rand_core"] }
getrandom = { version = "0.2", features = ["js"] }
rand = "0.8"
wasm-bindgen = "0.2"
js-sys = "0.3"
web-sys = { version = "0.3", features = [
    "Window",
    "Document",
    "Element",
    "HtmlElement",
    "HtmlTemplateElement",
    "Node",
    "Text",
    "Comment",
    "NodeList",
    "DomTokenList",
    "console",
] }
console_error_panic_hook = "0.1"

# Internal workspace dependencies
dx-www-core = { path = "../framework-core", optional = true }
dx-www-morph = { path = "../morph", optional = true }

# Zero-copy parsing
bytemuck = { version = "1.14", features = ["derive"] }

# Hashing for string deduplication
blake3 = "1.8"

# CRC32 checksum for binary validation
crc32fast = "1.4"

# Error handling
thiserror = "1.0"

[dev-dependencies]
hex = "0.4"
proptest = "1.4"

[features]
default = ["client"]
server = []                              # Only for dx build tool
client = ["dx-www-core", "dx-www-morph"] # Only for dx-www-runtime
