[package]
name = "dx-www"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true
repository.workspace = true
documentation = "https://docs.dx-www.dev/crates/dx-www"
description = "DX WWW Framework - Binary-first, multi-language web framework with file-system routing"
keywords = ["web-framework", "binary", "wasm", "routing", "dx"]
categories = ["web-programming", "wasm", "development-tools"]
readme = "README.md"
rust-version = "1.85"

[lib]
name = "dx_www"
path = "src/lib.rs"

[[bin]]
name = "dx-www"
path = "src/main.rs"

[features]
default = ["full"]
full = ["dev-server", "cli", "hot-reload"]
dev-server = ["tokio/net", "hyper", "tower"]
cli = ["clap"]
hot-reload = ["notify", "tokio-tungstenite"]
python = []
javascript = []
go = []

[dependencies]
# Core DX ecosystem
dx-style = { path = "../../style" }
dx-serializer = { path = "../../serializer" }
dx-www-binary = { workspace = true }
dx-www-compiler = { workspace = true }
dx-www-dom = { workspace = true }
dx-www-server = { workspace = true }
dx-www-error = { workspace = true }

# Zero-copy serialization
bytemuck = { workspace = true }
zerocopy = { version = "0.8", features = ["derive"] }
bytes = "1.9"

# Hashing and content addressing
blake3 = { workspace = true }
xxhash-rust = { version = "0.8", features = ["xxh3"] }

# Compression
flate2 = "1.1"

# File system and watching
notify = { version = "7.0", optional = true }
walkdir = "2.5"
globset = "0.4"
ignore = "0.4"

# Parsing and text processing
regex = "1.11"
memchr = "2.7"

# CLI framework
clap = { version = "4.5", features = ["derive", "env"], optional = true }
console = "0.15"
indicatif = "0.17"

# Serialization for config files
serde = { workspace = true }
serde_json = { workspace = true }
toml = "0.8"

# Error handling
thiserror = { workspace = true }
anyhow = { workspace = true }
miette = { version = "7.4", features = ["fancy"] }

# Memory mapping for zero-copy file access
memmap2 = "0.9"

# Async runtime
tokio = { version = "1.42", features = ["rt-multi-thread", "fs", "sync", "macros", "time"] }
tokio-tungstenite = { version = "0.24", optional = true }

# HTTP server for dev server
hyper = { version = "1.4", features = ["full"], optional = true }
tower = { version = "0.5", optional = true }
http = "1.1"
http-body-util = "0.1"
hyper-util = { version = "0.1", features = ["full"] }

# SIMD-accelerated operations
simdutf8 = "0.1"

# Logging and tracing
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }

# UUID generation
uuid = { version = "1.11", features = ["v4"] }

# Date/time handling
chrono = { version = "0.4", features = ["serde"] }

# Concurrency
dashmap = "6.1"
parking_lot = "0.12"

[dev-dependencies]
criterion = { workspace = true }
tempfile = "3.14"
pretty_assertions = "1.4"
insta = "1.41"
proptest = { workspace = true }

